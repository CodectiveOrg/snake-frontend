<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Buffer</title>

    <style>
      #buffer {
        display: flex;
        flex-direction: row-reverse;
        justify-content: center;

        height: 3rem;

        border: 1px solid black;

        > div {
          align-content: center;

          aspect-ratio: 1;

          border-inline: 1px solid black;

          text-align: center;
        }
      }
    </style>
  </head>
  <body>
    <div id="buffer"></div>

    <button onclick="inputHandler()">Input</button>
    <button onclick="outputHandler()">Output</button>

    <script>
      let buffer = [];
      const capacity = 10;

      document.addEventListener("keyup", (e) => {
        if (e.code === "Escape") {
          clearBuffer();
          return;
        }

        inputHandler(e.code);
      });

      setInterval(() => {
        outputHandler();
      }, 1000);

      function inputHandler(input) {
        if (buffer.length >= capacity) {
          return;
        }

        buffer.push(input || generateRandomInteger());
        render();
      }

      function outputHandler() {
        if (buffer.length === 0) {
          return;
        }

        buffer.shift();
        render();
      }

      function clearBuffer() {
        buffer = [];
        render();
      }

      function render() {
        const bufferElement = document.querySelector("#buffer");

        bufferElement.innerHTML = buffer
          .map((item) => `<div>${item}</div>`)
          .join("\n");
      }

      function generateRandomInteger(min = 11, max = 99) {
        return Math.floor(Math.random() * (max - min)) + min;
      }
    </script>
  </body>
</html>
